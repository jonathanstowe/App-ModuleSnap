#!/usr/bin/env perl6

use App::ModuleSnap;

multi sub MAIN(Str :$directory = '.') {

    my @parts = 'Snapshot', 'Auto', DateTime.now.Str.subst(/<[:+.-]>/,"", :g);
    my $name = @parts.join('::');
    my $dir-name = @parts.join('-');

    my $dir = $directory.IO.child($dir-name);

    my META6 $meta = App::ModuleSnap.get-meta(:$name);

    if !$dir.d {
        $dir.mkdir;
    }

    $dir.child('META6.json').spurt($meta.to-json);
    say "the snapshot has been written in the directory $dir";
}
# vim: expandtab shiftwidth=4 ft=perl6
